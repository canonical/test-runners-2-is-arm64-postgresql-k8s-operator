[32mINFO    [0m juju.model:model.py:2098 Deploying local:jammy/postgresql-k8s-1
[32mINFO    [0m juju.model:model.py:2972 Waiting for model:
  second-postgresql-k8s/0 [allocating] waiting: installing agent
  second-postgresql-k8s/1 [allocating] waiting: installing agent
[32mINFO    [0m juju.model:model.py:2972 Waiting for model:
  second-postgresql-k8s/0 [allocating] waiting: installing agent
  second-postgresql-k8s/1 [allocating] waiting: installing agent
[32mINFO    [0m juju.model:model.py:2972 Waiting for model:
  second-postgresql-k8s/0 [allocating] waiting: installing agent
  second-postgresql-k8s/1 [allocating] waiting: agent initialising
[32mINFO    [0m juju.model:model.py:2972 Waiting for model:
  second-postgresql-k8s/0 [allocating] waiting: agent initialising
  second-postgresql-k8s/1 [executing] maintenance: installing charm software
[32mINFO    [0m juju.model:model.py:2972 Waiting for model:
  second-postgresql-k8s/0 [executing] maintenance: installing charm software
  second-postgresql-k8s/1 [executing] maintenance: installing charm software
[32mINFO    [0m juju.model:model.py:2972 Waiting for model:
  second-postgresql-k8s/0 [executing] maintenance: installing charm software
  second-postgresql-k8s/1 [executing] maintenance: installing charm software
[32mINFO    [0m juju.model:model.py:2972 Waiting for model:
  second-postgresql-k8s/0 [executing] maintenance: installing charm software
  second-postgresql-k8s/1 [executing] maintenance: installing charm software
[32mINFO    [0m juju.model:model.py:2972 Waiting for model:
  second-postgresql-k8s/0 [executing] unknown: 
  second-postgresql-k8s/1 [executing] waiting: awaiting for cluster to start
[32mINFO    [0m juju.model:model.py:2972 Waiting for model:
  second-postgresql-k8s/0 [executing] unknown: 
  second-postgresql-k8s/1 [executing] waiting: awaiting for cluster to start
[32mINFO    [0m juju.model:model.py:2972 Waiting for model:
  second-postgresql-k8s/0 [idle] unknown: 
  second-postgresql-k8s/1 [executing] waiting: awaiting for cluster to start
[32mINFO    [0m juju.model:model.py:2972 Waiting for model:
  second-postgresql-k8s/0 [idle] unknown: 
  second-postgresql-k8s/1 [executing] waiting: awaiting for cluster to start
[32mINFO    [0m juju.model:model.py:2972 Waiting for model:
  second-postgresql-k8s/0 [idle] unknown: 
  second-postgresql-k8s/1 [executing] waiting: awaiting for cluster to start
[32mINFO    [0m juju.model:model.py:2972 Waiting for model:
  second-postgresql-k8s/0 [idle] unknown: 
  second-postgresql-k8s/1 [executing] waiting: awaiting for cluster to start
[32mINFO    [0m juju.model:model.py:2972 Waiting for model:
  second-postgresql-k8s/0 [idle] unknown: 
  second-postgresql-k8s/1 [executing] waiting: awaiting for cluster to start
[32mINFO    [0m juju.model:model.py:2972 Waiting for model:
  second-postgresql-k8s/0 [idle] unknown: 
  second-postgresql-k8s/1 [executing] waiting: awaiting for primary endpoint to be ready
[32mINFO    [0m juju.model:model.py:2972 Waiting for model:
  second-postgresql-k8s/0 [idle] unknown: 
  second-postgresql-k8s/1 [executing] waiting: awaiting for primary endpoint to be ready
[32mINFO    [0m juju.model:model.py:2972 Waiting for model:
  second-postgresql-k8s/0 [idle] unknown: 
  second-postgresql-k8s/1 [executing] waiting: awaiting for primary endpoint to be ready
[32mINFO    [0m juju.model:model.py:2972 Waiting for model:
  second-postgresql-k8s/0 [idle] unknown: 
  second-postgresql-k8s/1 [executing] waiting: awaiting for primary endpoint to be ready
[32mINFO    [0m juju.model:model.py:2972 Waiting for model:
  second-postgresql-k8s/0 [idle] unknown: 
  second-postgresql-k8s/1 [executing] waiting: awaiting for primary endpoint to be ready
[32mINFO    [0m juju.model:model.py:2972 Waiting for model:
  second-postgresql-k8s/0 [idle] unknown: 
  second-postgresql-k8s/1 [executing] waiting: awaiting for primary endpoint to be ready
[32mINFO    [0m juju.model:model.py:2972 Waiting for model:
  second-postgresql-k8s/0 [idle] unknown: 
  second-postgresql-k8s/1 [executing] waiting: awaiting for primary endpoint to be ready
[32mINFO    [0m juju.model:model.py:2972 Waiting for model:
  second-postgresql-k8s/0 [idle] unknown: 
  second-postgresql-k8s/1 [idle] waiting: awaiting for primary endpoint to be ready
[32mINFO    [0m juju.model:model.py:2972 Waiting for model:
  second-postgresql-k8s/0 [idle] unknown: 
  second-postgresql-k8s/1 [idle] active: Primary
[32mINFO    [0m juju.model:model.py:2972 Waiting for model:
  second-postgresql-k8s/0 [idle] waiting: awaiting for cluster to start
  second-postgresql-k8s/1 [idle] active: Primary
[32mINFO    [0m juju.model:model.py:2972 Waiting for model:
  second-postgresql-k8s/0 [idle] waiting: awaiting for cluster to start
  second-postgresql-k8s/1 [idle] maintenance: reconfiguring cluster
[32mINFO    [0m juju.model:model.py:2972 Waiting for model:
  second-postgresql-k8s/0 [idle] waiting: awaiting for cluster to start
  second-postgresql-k8s/1 [idle] active: Primary
[32mINFO    [0m juju.model:model.py:2972 Waiting for model:
  second-postgresql-k8s/0 [idle] waiting: awaiting for cluster to start
  second-postgresql-k8s/1 [idle] active: Primary
[32mINFO    [0m juju.model:model.py:2972 Waiting for model:
  second-postgresql-k8s/0 [executing] waiting: awaiting for member to start
  second-postgresql-k8s/1 [executing] waiting: awaiting for cluster to start
[32mINFO    [0m juju.model:model.py:2972 Waiting for model:
  second-postgresql-k8s/0 [idle] waiting: awaiting for member to start
  second-postgresql-k8s/1 [idle] waiting: awaiting for cluster to start
[32mINFO    [0m juju.model:model.py:2972 Waiting for model:
  second-postgresql-k8s/0 [idle] active: 
  second-postgresql-k8s/1 [idle] waiting: awaiting for cluster to start
[32mINFO    [0m juju.model:model.py:2972 Waiting for model:
  second-postgresql-k8s/0 [idle] active: 
  second-postgresql-k8s/1 [idle] waiting: awaiting for cluster to start
[32mINFO    [0m juju.model:model.py:2972 Waiting for model:
  second-postgresql-k8s/0 [idle] active: 
  second-postgresql-k8s/1 [idle] waiting: awaiting for cluster to start
[32mINFO    [0m juju.model:model.py:2972 Waiting for model:
  second-postgresql-k8s/0 [idle] active: 
  second-postgresql-k8s/1 [idle] waiting: awaiting for cluster to start
[32mINFO    [0m pytest_operator.plugin:plugin.py:862 Model status:

Model  Controller          Cloud/Region        Version  SLA          Timestamp
test   microk8s-localhost  microk8s/localhost  3.4.4    unsupported  02:05:52Z

App                    Version  Status   Scale  Charm                Channel      Rev  Address         Exposed  Message
postgresql-k8s         14.12    waiting      3  postgresql-k8s                      0  10.152.183.163  no       installing agent
postgresql-test-app             active       1  postgresql-test-app  latest/edge  191  10.152.183.37   no       
second-postgresql-k8s  14.12    waiting      2  postgresql-k8s                      1  10.152.183.203  no       installing agent

Unit                      Workload  Agent  Address      Ports  Message
postgresql-k8s/0*         active    idle   10.1.201.76         Primary
postgresql-k8s/1          waiting   idle   10.1.201.78         awaiting for cluster to start
postgresql-k8s/2          active    idle   10.1.201.77         
postgresql-test-app/0*    active    idle   10.1.201.75         
second-postgresql-k8s/0   active    idle   10.1.201.81         
second-postgresql-k8s/1*  waiting   idle   10.1.201.82         awaiting for cluster to start

[32mINFO    [0m pytest_operator.plugin:plugin.py:868 Juju error logs:

unit-postgresql-k8s-2: 01:46:12 ERROR unit.postgresql-k8s/2.juju-log database-peers:0: Failed to check if restart is pending: connection already closed
unit-second-postgresql-k8s-0: 01:59:54 ERROR juju.worker.dependency "log-sender" manifold worker returned unexpected error: sending log message: websocket: close 1005 (no status): websocket: close sent
unit-second-postgresql-k8s-0: 02:01:46 ERROR unit.second-postgresql-k8s/0.juju-log database-peers:7: Uncaught exception while in charm code:
Traceback (most recent call last):
  File "/var/lib/juju/agents/unit-second-postgresql-k8s-0/charm/./src/charm.py", line 1837, in <module>
    main(PostgresqlOperatorCharm, use_juju_for_storage=True)
  File "/var/lib/juju/agents/unit-second-postgresql-k8s-0/charm/venv/ops/main.py", line 548, in main
    manager.run()
  File "/var/lib/juju/agents/unit-second-postgresql-k8s-0/charm/venv/ops/main.py", line 527, in run
    self._emit()
  File "/var/lib/juju/agents/unit-second-postgresql-k8s-0/charm/venv/ops/main.py", line 513, in _emit
    self.framework.reemit()
  File "/var/lib/juju/agents/unit-second-postgresql-k8s-0/charm/venv/ops/framework.py", line 870, in reemit
    self._reemit()
  File "/var/lib/juju/agents/unit-second-postgresql-k8s-0/charm/venv/ops/framework.py", line 950, in _reemit
    custom_handler(event)
  File "/var/lib/juju/agents/unit-second-postgresql-k8s-0/charm/lib/charms/tempo_k8s/v1/charm_tracing.py", line 647, in wrapped_function
    return callable(*args, **kwargs)  # type: ignore
  File "/var/lib/juju/agents/unit-second-postgresql-k8s-0/charm/./src/charm.py", line 827, in _on_postgresql_pebble_ready
    self.unit.set_workload_version(self._patroni.rock_postgresql_version)
  File "/var/lib/juju/agents/unit-second-postgresql-k8s-0/charm/venv/ops/model.py", line 613, in set_workload_version
    raise TypeError(
TypeError: workload version must be a str, not NoneType: None
unit-second-postgresql-k8s-0: 02:01:47 ERROR juju.worker.uniter.operation hook "database-peers-relation-changed" (via hook dispatching script: dispatch) failed: exit status 1

[32mINFO    [0m pytest_operator.plugin:plugin.py:947 Forgetting model main...